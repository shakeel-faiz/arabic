{
  "date" : "2021-06-29",
  "keywords" :["com file", "what is a com file", "file", "com example", "com file extension", "extension", "format"],
  "author" : {
    "display_name" : "Muhammad Umar"
} ,
  "draft" : "false",
  "toc" : true,
  "description":"تعرف على تنسيق ملف COM وواجهات برمجة التطبيقات التي يمكنها إنشاء ملفات COM وفتحها." ,
  "title" :"تنسيق ملف أوامر COM - DOS" ,
  "linktitle" : "COM",
  "menu" : {
    "docs" : {
      "parent" : "executable"
}
} ,
  "lastmod" : "2021-06-29"
}

## ما هو ملف COM؟
تُستخدم ملفات COM ببساطة لتنفيذ مجموعة من الأوامر أو التعليمات. يتكون ملف COM من برنامج قابل للتنفيذ يمكن تشغيله من Windows أو MS-DOS. وبالمثل ملف EXE ، يتم حفظ ملف COM أيضًا بتنسيق ثنائي ولكنه يختلف عن ملف EXE لأنه لا يحتوي على رأس أو بيانات وصفية ، كما أنه يحتوي على أقصى حجم يبلغ 64 كيلوبايت تقريبًا. عند تشغيل ملف COM لأول مرة على نظام 32 بت ، فإنه يطالب بتثبيت مكون NT Virtual DOS Machine (NTVDM). يمكن تشغيل ملف COM على الإصدار 64 بت من Microsoft Windows باستخدام جهاز ظاهري يدعم بيئة MS-DOS.

## تنسيق ملف COM
تنسيق ملف COM هو تنسيق ثنائي قابل للتنفيذ يستخدم في Microsoft Windows أو MS-DOS. يتكون هيكلها من مجموعة من التعليمات فقط ؛ لا يحتوي على رأس ولا يحتوي على بيانات وصفية قياسية. يخزن جميع بياناته وكودته في مقطع واحد فقط ويبلغ حجم ملفه الثنائي 64 كيلوبايت كحد أقصى. لا ينتقل تنسيق الملف هذا عند محاولة إعادة التشغيل. لذلك يقوم نظام التشغيل بتحميله على عنوان محدد مسبقًا. علاوة على ذلك ، من الممكن إنشاء ملف COM لتنفيذه في ظل نظامي التشغيل في شكل ** ثنائي الدهون **. لا يوجد أي توافق فعلي على مستوى التعليمات. تم تحديد الإرشادات الموجودة في نقطة الدخول لتكون متساوية في الوظائف ولكنها مختلفة في كلا نظامي التشغيل ، ولجعل البرنامج قيد التشغيل ، انتقل إلى قسم نظام التشغيل قيد الاستخدام. إنه في الأساس برنامجان مختلفان لهما نفس الإجراء في ملف واحد ، مسبوقًا برمز اختيار البرنامج المراد استخدامه.
### ملف COM مثال
عند تنفيذ ملف COM ، تتم قراءة الإرشادات من البايت الأول ويتم اتباعها على التوالي حتى يتم العثور على الإرشادات الأخيرة. فيما يلي مثال على رمز ASM:

```
[BITS 16]		;Set code generation to 16 bit mode
[ORG 0x0100]		;Set code start address to 0100h


[SEGMENT .text]		;Main code segment
    mov ah, 9 ; DOS print string function
    mov dx, hello
    int 21h
    ;Exit to DOS
    mov ah, 4ch
    int 21h
[SEGMENT .data]		;Initialised data segment
hello:   db   'Hello, .COM programmer!',13,10,'$'
```

## مراجع

* [ملف COM - بواسطة Wikipewdia](https://en.wikipedia.org/wiki/COM_file)

