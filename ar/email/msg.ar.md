{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
} ,
  "draft" : "false",
  "toc" : true,
  "title" :"MSG - تنسيق البريد الإلكتروني لبرنامج Microsoft Outlook" ,
  "description":"تعرف على تنسيق ملف MSG وواجهات برمجة التطبيقات التي يمكنها إنشاء ملفات MSG وفتحها." ,
  "linktitle" : "MSG",
  "menu" : {
    "docs" : {
      "parent" : "email"
}
} ,
  "lastmod" : "2019-09-10"
}

## ما هو ملف MSG؟

MSG هو تنسيق ملف يستخدمه [Microsoft Outlook](https://products.office.com/en-us/outlook/email-and-calendar-software-microsoft-outlook؟rtc#1) و Exchange لتخزين رسائل البريد الإلكتروني أو جهة اتصال أو موعد أو مهام أخرى. قد تحتوي هذه الرسائل على واحد أو أكثر من حقول البريد الإلكتروني ، مع المرسل والمستلم والموضوع والتاريخ ونص الرسالة أو معلومات الاتصال وتفاصيل الموعد وواحد أو أكثر من مواصفات المهمة. الخصائص التي تشكل كائن الرسالة ، بما في ذلك هي أيضًا جزء من ملف MSG. يحتوي ملف MSG على رؤوس ونص رسالة رئيسية وارتباطات تشعبية كنص ASCII عادي. تتلاءم ملفات MSG أيضًا مع البرامج التي تحتاج إلى واجهة برمجة تطبيقات المراسلة من Microsoft (MAPI).

## هيكل ملف MSG

تنسيق CFB_3 هو أساس ملف MSG. يعتمد النموذج على مفاهيم التخزين والتدفق ، وهو قريب جدًا من الدلائل والملفات. لذلك فإن الاختلاف الرئيسي في الأول هو التسلسل الهرمي بأكمله ، المحزم في ملف مميز ، يسمى الملف المركب. تشكل الكائنات ملفات الرسائل وتتكون من خاصية واحدة أو مجموعاتها. تسهل هذه القدرة التطبيقات على تخزين البيانات المعقدة والمنظمة في ملف واحد. يحدد هذا التنسيق أيضًا مخازن متعددة ، كل تخزين يمثل كائن الرسالة كمكون رئيسي. تحتوي هذه المستودعات على عدد من التدفقات التي تمثل خاصية لهذا المكون. من الممكن أيضًا تعشيش التخزين.

## خصائص Mapi

في المستوى العلوي من ملف .msg ، تحتوي المخازن على تدفقات تخزن الخصائص فيها. يمكن تصنيف الخصائص على النحو التالي:

* خصائص طول ثابت
* خصائص الطول المتغير
* خصائص متعددة القيم

بغض النظر عن الفئة ، فإن الخاصية هي إما علامة أو مسماة. ومع ذلك ، فإن معلومات الخرائط المناسبة مطلوبة للخصائص المسماة كما هو محدد بواسطة تخزين الخرائط الخاصة بهم.

## المخازن

تشكل المخازن المكونات الرئيسية لكائن الرسالة. يوضح تنسيق ملف MSG المخازن التالية:

## هيكل المستوى الأعلى

يمثل كائن الرسالة المستوى الأعلى الكامل لتنسيق ملف MSG. اعتمادًا على النوع والخصائص وعدد المستلمين وكائنات المرفقات ، يمكن أن يحتوي كائن الرسالة على مخازن دفق مختلفة في ملف MSG المقابل.

### العلاقة مع الهياكل الأخرى

يحتوي تنسيق ملف Msg على العلاقات التالية مع الهياكل الأخرى:

* أساس .msg هو تنسيق ملف ثنائي مركب.
* يتم استخدام الخصائص التي يستخدمها بروتوكول كائن الرسائل والمرفقات بواسطة هذا التنسيق.

## سيناريوهات لتجنب تنسيقات MSG

يمكن مشاركة كائن الرسالة بين العملاء أو مخازن الرسائل التي تستخدم نظام الملفات .msg. هناك بعض الحالات التي يكون فيها تخزين كائن الرسائل بتنسيق ملف .msg غير مناسب. فمثلا:

* في حالة الاحتفاظ بأرشيف مستقل كبير ، من الأفضل استخدام تنسيق كامل الميزات يمكن من خلاله عرض العروض بدقة أكبر.
* إذا كان جهاز الاستقبال غير معروف ، فمن المحتمل أن التنسيق غير مدعوم من طرف جهاز الاستقبال وقد يتم تسليم التنسيق الخاص أو غير ذي الصلة.

## مثال على ملف MSG

للحصول على فكرة عن شكل ملف MSG ، يمكنك تنزيل [نموذج ملف MSG](https://products.conholdate.app/viewer/view/mL7cmq6qYbcNG329P/sample-msg-file.msg) وفتحه على الكمبيوتر لعرض محتوياته.

## مراجع

* [[MS-OXMSG]: تنسيق ملف Outlook MSG](https://msdn.microsoft.com/en-us/library/cc463912 (v # exchg.80) .aspx)

