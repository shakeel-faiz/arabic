{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
} ,
  "draft" : "false",
  "toc" : true,
  "title" :"ONETOC2 - تنسيق ملف Microsoft OneNote" ,
  "description":"تعرف على تنسيق ملف ONETOC2 وواجهات برمجة التطبيقات التي يمكنها إنشاء ملفات ONETOC2 وفتحها." ,
  "linktitle" : "ONETOC2",
  "menu" : {
    "docs" : {
      "parent" : "note-taking"
}
} ,
  "lastmod" : "2019-09-10"
}

## ما هو ONETOC2؟ ##

أولئك الذين عملوا مع تطبيق [Microsoft OneNote](https://products.office.com/en-us/onenote/digital-note-taking-app) ربما لاحظوا وجود ملفات .onetoc2 في مجلد دفتر الملاحظات. يقوم Microsoft OneNote بإنشاء ملف .onetoc2 ثنائي كجدول محتويات للاحتفاظ بفهرس حول ترتيب أقسام تدوين الملاحظات المختلفة في دفتر ملاحظات. دفتر الملاحظات هو مجموعة من ملفات الأقسام المخزنة في نفس الدليل. يستخدم ملف .onetoc2 مجموعة من الخصائص لتحديد الإعدادات مثل ترتيب الأقسام داخل دفتر الملاحظات ولون دفتر الملاحظات.

عند إنشاء دفتر ملاحظات في OneNote 2016 ، يتم حفظه تلقائيًا بتنسيق ملف 2010-2016 الجديد. ستحتاج إلى هذا التنسيق إذا كنت تريد أن تعمل جميع الميزات الموجودة في OneNote 2016 ، مثل المعادلات الرياضية والملاحظات المرتبطة ، بشكل صحيح.

## تنسيق ملف ONETOC2 ##

يتم تمثيل تنسيق ملف .onetoc2 على أنه تنسيق ملف متجر OneNote Revision وهو عبارة عن مجموعة من الهياكل التي تحدد مخزنًا للمراجعات منظمًا في مسافات كائنات مرجعية ، ويحتوي على كائنات مع مجموعات خصائص ، ويحتوي على سجل معاملات لضمان تكامل الملف عبر غير متزامن يكتب. تتوفر المواصفات الكاملة لتنسيق ملف .onetoc2 [عبر الإنترنت](https://msdn.microsoft.com/en-us/library/dd951288 (v # office.12) .aspx) ويمكن الرجوع إليها لتطوير التطبيقات .

### هيكل الملف ###

يجب أن يبدأ ملف مخزن المراجعة ببنية ** Header **. يتم تقسيم ما تبقى من الملف إلى كتل من البايت ، حيث يتم تحديد حجم وبنية كل كتلة بواسطة الحقل الذي يشير إليها. يمكن الوصول إلى الكتلة إذا تمت الإشارة إليها بواسطة بنية ** Header ** ، أو إذا تمت الإشارة إليها بواسطة حقل في كتلة أخرى قابلة للوصول. يجب تجاهل البيانات الموجودة خارج هيكل ** Header ** وأي كتل يمكن الوصول إليها.

يتم محاذاة جميع الهياكل على حدود 1 بايت. يتم توقيع جميع الأعداد الصحيحة ما لم ينص على خلاف ذلك. جميع الحقول [little-endian](https://msdn.microsoft.com/en-us/library/dd773246 (v # office.12) .aspx # gt_079478cb-f4c5-4ce5-b72b-2144da5d2ce7) ما لم يتم تحديد خلاف ذلك.

#### العنوان ####

يتكون رأس ملف .ONE من أجزاء تحتوي على معرفات وحقول فريدة مختلفة لتمثيل معلومات الملف على النحو التالي:

`GUIDFileType (16 بايت):` GUID الذي يحدد نوع ملف مخزن المراجعة. يجب أن تكون إحدى القيم من الجدول التالي.

| تنسيق الملف | القيمة
--- | --- |
|.one|{7B5C52E4-D88C-4DA7-AEB1-5378D02996D3}
|.onetoc2|{43FF2FA1-EFD9-4C76-9EE2-10EA5722765F}

`GUIDFile (16 بايت):` GUID الذي يحدد هوية ملف مخزن المراجعة هذا. يجب أن تكون فريدة من نوعها على مستوى العالم.

`GuidLegacyFileVersion (16 بايت):` يجب أن يكون "{00000000-0000-0000-0000-000000000000}" ويجب تجاهله.

`GUIDFileFormat (16 بايت):` GUID الذي يحدد أن الملف هو ملف مخزن مراجعة. يجب أن يكون "{109ADD3F-911B-49F5-A5D0-1791EDC8AED8}".

`ffvLastCodeThatWroteToThisFile (4 بايت):` `عدد صحيح بدون إشارة. يجب أن تكون إحدى القيم الموجودة في الجدول التالي ، حسب نوع الملف.

| تنسيق الملف | القيمة
--- | --- |
| .one | 0x0000002A
| .onetoc2 | 0x0000001B

`ffvOldestCodeThatHasWrittenToThisFile (4 بايت):` عدد صحيح بدون إشارة. يجب أن تكون إحدى القيم الواردة في الجدول التالي ، اعتمادًا على تنسيق الملف لهذا الملف.


| تنسيق الملف | القيمة
--- | --- |
| .one | 0x0000002A
| .onetoc2 | 0x0000001B

`ffvNewestCodeThatHasWrittenToThisFile (4 بايت):` عدد صحيح بدون إشارة. يجب أن تكون إحدى القيم الواردة في الجدول التالي ، اعتمادًا على تنسيق الملف لهذا الملف.
:


| تنسيق الملف | القيمة
--- | --- |
| .one | 0x0000002A
| .onetoc2 | 0x0000001B

`ffvOldestCodeThatMayReadThisFile (4 بايت):` `عدد صحيح بدون إشارة. يجب أن تكون إحدى القيم الواردة في الجدول التالي ، اعتمادًا على تنسيق الملف لهذا الملف.


| تنسيق الملف | القيمة
--- | --- |
| .one | 0x0000002A
| .onetoc2 | 0x0000001B

## مراجع ##

* [[MS-ONESTORE] - تنسيق ملف OneNote](https://msdn.microsoft.com/en-us/library/dd951288 (v # office.12) .aspx)
* [Microsoft OneNote - ويكيبيديا](https://en.wikipedia.org/wiki/Microsoft_OneNote#References)

