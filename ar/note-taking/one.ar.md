{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
} ,
  "draft" : "false",
  "toc" : true,
  "title" :"ONE - تنسيق ملف Microsoft OneNote" ,
  "description":"تعرف على تنسيق ملف ONE وواجهات برمجة التطبيقات التي يمكنها إنشاء ملفات ONE وفتحها." ,
  "linktitle" : "ONE",
  "menu" : {
    "docs" : {
      "parent" : "note-taking"
}
} ,
  "lastmod" : "2019-09-10"
}

## ما هو ملف .ONE؟ ##

يتم إنشاء الملف الذي يمثله ملحق .ONE بواسطة تطبيق Microsoft OneNote. يتيح لك OneNote جمع المعلومات باستخدام التطبيق كما لو كنت تستخدم لوحة المسودة لتدوين الملاحظات. يمكن أن تحتوي ملفات OneNote على عناصر مختلفة يمكن وضعها في مواقع غير ثابتة على صفحات المستند. قد تحتوي هذه العناصر على نص ، وكتابة يدوية رقمية ، وكائنات منسوخة من تطبيقات أخرى بما في ذلك الصور والرسومات ومقاطع الوسائط المتعددة (الصوت / الفيديو). تقدم Microsoft الآن إصدارًا عبر الإنترنت من OneNote كجزء من Office365 حيث يمكن مشاركة Notes مع مستخدمي OneNote الآخرين عبر الإنترنت.

## مواصفات تنسيق ملف .ONE ##

يوفر تنسيق ملف OneNote طريقة فعالة لتمثيل الملاحظات الرقمية كمجموعات هرمية من الأقسام والصفحات. تحتوي كل صفحة على محتوى محدد بواسطة المستخدم في بنية محددة للتمثيل بواسطة تنسيق الملف Document Object Model (DOM). نموذج البيانات لهذا التنسيق كما هو موضح أدناه.

### نظرة عامة على الهيكل ###

كما هو موضح في نموذج البيانات لتنسيق ملف OneNote ، يتكون مستند OneNote من عناصر مختلفة.

#### الجزء ####

القسم هو الحاوية العلوية في ملف OneNote والتي تحتوي على عناصر مختلفة فيه مثل:

* الصفحات
* البيانات الوصفية
* الخصائص

تتضمن البيانات الوصفية والخصائص اسم القسم ، وتعريف الصفحات الموجودة في القسم ، والترتيب الذي تظهر به تلك الصفحات. يشير المصطلح "قسم" إلى جميع الصفحات الموجودة في أحد الأقسام وتمثيل تلك البيانات في ملف مخزن مراجعة OneNote® ، والذي يحتوي على ملحق اسم ملف واحد.

#### صفحة ####

المحتوى المعرف من قبل المستخدم في مستند OneNote مضمن داخل صفحة. تتضمن معلومات الصفحة النص والقوائم والجداول وعناوين الصفحات والصور وعلامات الملاحظات. تتكون الصفحة من كائنات مخطط تفصيلي تتم إضافة معظم الكائنات المضمنة إليها. يمكن تعيين اسم لكل صفحة للتمثيل ذي المعنى ويمكن إضافة الكائنات مباشرة إلى الصفحات أيضًا. يمكن أن تحتوي الصفحة أيضًا على صفحات فرعية في نظام هرمي.

#### الخصائص ومجموعات العقارات ####

تتكون محتويات OneNote من الخصائص ومجموعات الخصائص وكائنات بيانات الملفات. مجموعة الخصائص هي مجموعة من الخصائص التي تمثل نوعًا ما من المحتوى. كائن بيانات الملف هو كتلة من البيانات الثنائية التي تحتوي على صور أو ملفات مضمنة أو محتوى صوتي / فيديو.

#### OneNote Notebook ####

دفتر الملاحظات هو مجموعة من ملفات الأقسام المخزنة في نفس الدليل. يتم استخدام مجموعة من الخصائص لتحديد الإعدادات مثل ترتيب الأقسام داخل دفتر الملاحظات ولون دفتر الملاحظات.

### هيكل الملف ###

يجب أن يبدأ ملف مخزن المراجعة ببنية ** Header **. يتم تقسيم ما تبقى من الملف إلى كتل من البايت ، حيث يتم تحديد حجم وبنية كل كتلة بواسطة الحقل الذي يشير إليها. يمكن الوصول إلى الكتلة إذا تمت الإشارة إليها بواسطة بنية ** Header ** ، أو إذا تمت الإشارة إليها بواسطة حقل في كتلة أخرى قابلة للوصول. يجب تجاهل البيانات الموجودة خارج هيكل ** Header ** وأي كتل يمكن الوصول إليها.

يتم محاذاة جميع الهياكل على حدود 1 بايت. يتم توقيع جميع الأعداد الصحيحة ما لم ينص على خلاف ذلك. جميع الحقول [little-endian](https://msdn.microsoft.com/en-us/library/dd773246 (v # office.12) .aspx # gt_079478cb-f4c5-4ce5-b72b-2144da5d2ce7) ما لم يتم تحديد خلاف ذلك.

#### العنوان ####

يتكون رأس ملف .ONE من أجزاء تحتوي على معرفات وحقول فريدة مختلفة لتمثيل معلومات الملف على النحو التالي:

`GUIDFileType (16 بايت):` GUID الذي يحدد نوع ملف مخزن المراجعة. يجب أن تكون إحدى القيم من الجدول التالي.


| تنسيق الملف | القيمة
--- | --- |
|.one|{7B5C52E4-D88C-4DA7-AEB1-5378D02996D3}
|.onetoc2|{43FF2FA1-EFD9-4C76-9EE2-10EA5722765F}

`GUIDFile (16 بايت):` GUID الذي يحدد هوية ملف مخزن المراجعة هذا. يجب أن تكون فريدة من نوعها على مستوى العالم.

`GuidLegacyFileVersion (16 بايت):` يجب أن يكون "{00000000-0000-0000-0000-000000000000}" ويجب تجاهله.

`GUIDFileFormat (16 بايت):` GUID الذي يحدد أن الملف هو ملف مخزن مراجعة. يجب أن يكون "{109ADD3F-911B-49F5-A5D0-1791EDC8AED8}".

`ffvLastCodeThatWroteToThisFile (4 بايت):` `عدد صحيح بدون إشارة. يجب أن تكون إحدى القيم الموجودة في الجدول التالي ، حسب نوع الملف.

| تنسيق الملف | القيمة
--- | --- |
| .one | 0x0000002A
| .onetoc2 | 0x0000001B

`ffvOldestCodeThatHasWrittenToThisFile (4 بايت):` عدد صحيح بدون إشارة. يجب أن تكون إحدى القيم الواردة في الجدول التالي ، اعتمادًا على تنسيق الملف لهذا الملف.


| تنسيق الملف | القيمة
--- | --- |
| .one | 0x0000002A
| .onetoc2 | 0x0000001B

`ffvNewestCodeThatHasWrittenToThisFile (4 بايت):` عدد صحيح بدون إشارة. يجب أن تكون إحدى القيم الواردة في الجدول التالي ، اعتمادًا على تنسيق الملف لهذا الملف.

| تنسيق الملف | القيمة
--- | --- |
| .one | 0x0000002A
| .onetoc2 | 0x0000001B

`ffvOldestCodeThatMayReadThisFile (4 بايت):` `عدد صحيح بدون إشارة. يجب أن تكون إحدى القيم الواردة في الجدول التالي ، اعتمادًا على تنسيق الملف لهذا الملف.

| تنسيق الملف | القيمة
--- | --- |
| .one | 0x0000002A
| .onetoc2 | 0x0000001B

`fcrLegacyFreeChunkList (8 بايت): هيكل ** FileChunkReference32 ** يجب أن يكون له قيمة" fcrZero ".

`fcrLegacyTransactionLog (8 بايت):` A ** FileChunkReference32 ** هيكل يجب أن يكون "fcrNil".

`cTransactionsInLog (4 بايت):` `عدد صحيح بدون إشارة يحدد عدد المعاملات في سجل المعاملات. يجب ألا تكون صفراً.

`cbLegacyExpectedFileLength (4 بايت):` `عدد صحيح بدون إشارة يجب أن يكون صفرًا ، ويجب تجاهله.

`rgbPlaceholder (8 بايت): عدد صحيح بدون إشارة يجب أن يكون صفرًا ويجب تجاهله.

`fcrLegacyFileNodeListRoot (8 بايت):` A ** FileChunkReference32 ** هيكل يجب أن يكون "fcrNil".

`cbLegacyFreeSpaceInFreeChunkList (4 بايت): عدد صحيح بدون إشارة يجب أن يكون صفراً ، ويجب تجاهله.

`fNeedsDefrag (1 بايت):` يجب تجاهله.

`fRepairedFile (1 بايت):` يجب تجاهله.

`fNeedsGarbageCollect (1 بايت):` يجب تجاهله.

`fHasNoEmbeddedFileObjects (1 بايت):` `عدد صحيح بدون إشارة يجب أن يكون صفراً ، ويجب تجاهله.

`` GUIDAncestor (16 بايت): `` GUID الذي يحدد الحقل ** Header.guidFile ** في ملف جدول المحتويات ، المعطى في الجدول التالي:


| تنسيق ملف جدول المحتويات | موقع ملف جدول المحتويات
--- | --- |
| ملف المقطع - .One | يوجد ملف جدول المحتويات في نفس الدليل مثل هذا الملف.
| ملف جدول المحتويات - .onetoc2 | يوجد ملف جدول المحتويات في الدليل الأصلي لهذا الملف.

إذا كان GUID هو {00000000-0000-0000-0000-000000000000} ، فإن هذا الحقل لا يشير إلى ملف جدول المحتويات.

`crcName (4 بايت):` عدد صحيح بدون إشارة يحدد قيمة CRC لاسم ملف مخزن المراجعة هذا. الاسم هو تمثيل Unicode لاسم الملف بامتداده وحرف فارغ إضافي في النهاية. يتم دائمًا حساب CRC هذا باستخدام خوارزمية CRC لملف واحد ، بغض النظر عن تنسيق ملف مخزن المراجعة هذا.

`fcrHashedChunkList (12 بايت):` A ** FileChunkReference64x32 ** بنية تحدد مرجعًا لأول ** FileNodeListFragment ** في قائمة الأجزاء المجزأة. إذا كانت قيمة ** هيكل ** FileChunkReference64x32 ** هي "fcrZero" أو "fcrNil" ، فإن قائمة الأجزاء المجزأة غير موجودة.

`fcrTransactionLog (12 بايت):` بنية ** FileChunkReference64x32 ** تحدد مرجعًا إلى أول بنية ** TransactionLogFragment ** في سجل المعاملات. يجب ألا تكون قيمة الحقل ** fcrTransactionLog ** "fcrZero" ويجب ألا تكون "fcrNil".

`fcrFileNodeListRoot (12 بايت):` A ** FileChunkReference64x32 ** بنية تحدد مرجعًا لقائمة عقدة ملف الجذر. يجب ألا تكون قيمة الحقل ** fcrFileNodeListRoot ** "fcrZero" ويجب ألا تكون "fcrNil".

`fcrFreeChunkList (12 بايت): هيكل ** FileChunkReference64x32 ** الذي يحدد مرجعًا إلى أول بنية ** FreeChunkListFragment **. إذا كانت قيمة ** FileChunkReference64x32 ** هي قيمة "fcrZero" أو "fcrNil" ، فإن قائمة الأجزاء المجانية غير موجودة.

`cbExpectedFileLength (8 بايت):` عدد صحيح بدون إشارة يحدد الحجم بالبايت لملف مخزن المراجعة هذا.

`cbFreeSpaceInFreeChunkList (8 بايت):` `عدد صحيح بدون إشارة يجب أن يحدد الحجم بالبايت للمساحة الحرة المحددة بواسطة قائمة القطع الحرة.

`GUIDFileVersion (16 بايت):` A GUID. عند تغيير قيمة الحقل ** cTransactionsInLog ** أو الحقل ** GuidDenyReadFileVersion ** ، يجب تغيير ** GuidFileVersion ** إلى GUID جديد.

`nFileVersionGeneration (8 بايت):` `عدد صحيح بدون إشارة يحدد عدد المرات التي تغير فيها الملف. يجب أن تتم زيادتها عند تغيير الحقل ** GuidFileVersion **.

`GUIDDenyReadFileVersion (16 بايت):` A GUID. عندما يتم تغيير محتويات الملف الحالية ، باستثناء هيكل ** Header ** للملف وكتل التخزين غير المستخدمة ، يجب تغيير ** GUIDDenyReadFileVersion ** إلى GUID جديد.

`grfDebugLogFlags (4 بايت):` يجب أن يكون صفرًا. يجب تجاهله.

`fcrDebugLog (12 بايت):` A ** FileChunkReference64x32 ** هيكل يجب أن يكون له قيمة "fcrZero". يجب تجاهله.

`fcrAllocVerificationFreeChunkList (12 بايت):` A ** FileChunkReference64x32 ** هيكل يجب أن يكون "fcrZero". يجب تجاهله.

`bnCreated (4 بايت):` عدد صحيح بدون إشارة يحدد رقم بناء التطبيق الذي أنشأ ملف مخزن المراجعة هذا. يجب تجاهله.

`bnLastWroteToThisFile (4 بايت):` `عدد صحيح بدون إشارة يحدد رقم إنشاء التطبيق الذي كتب مؤخرًا إلى ملف مخزن المراجعة هذا. يجب تجاهله.

`bnOldestWritten (4 بايت):` عدد صحيح بدون إشارة يحدد رقم إنشاء أقدم تطبيق كتب إلى ملف مخزن المراجعة هذا. يجب تجاهله.

`bnNewestWritten (4 بايت):` عدد صحيح بدون إشارة يحدد رقم إنشاء أحدث تطبيق كتب إلى ملف مخزن المراجعة هذا. يجب تجاهله.

`rgbReserved (728 bytes):` يجب أن يكون صفرًا. يجب تجاهله.

## مراجع ##

* [[MS-ONESTORE] - تنسيق ملف OneNote](https://msdn.microsoft.com/en-us/library/dd951288 (v # office.12) .aspx)
* [Microsoft OneNote - ويكيبيديا](https://en.wikipedia.org/wiki/Microsoft_OneNote#References)

